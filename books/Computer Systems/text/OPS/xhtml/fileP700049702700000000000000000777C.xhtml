<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>Solutions to Practice Problems </title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="pcalibre1 pcalibre2 pcalibre">
<section id="P700049702700000000000000000777C" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre1 pcalibre2 pcalibre4" id="P700049702700000000000000004625E" data-uri="chapter09.xhtml#P700049702700000000000000004625E" epub:type="title"><span class="pcalibre1 pcalibre21 pcalibre2">Solutions to Practice Problems </span></h1></header>
<section id="P700049702700000000000000000777E" data-uri="chapter09.xhtml#P700049702700000000000000000777E" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P700049702700000000000000004625F" data-uri="chapter09.xhtml#P700049702700000000000000004625F" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000703D.xhtml#P7000497027000000000000000007049"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.1 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000703D.xhtml#P7000497027000000000000000007048">805</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P7000497027000000000000000046260" data-uri="chapter09.xhtml#P7000497027000000000000000046260">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046261" data-uri="chapter09.xhtml#P7000497027000000000000000046261"><p id="P7000497027000000000000000046262" data-uri="chapter09.xhtml#P7000497027000000000000000046262" class="pcalibre1 pcalibre2 pcalibre40">This problem gives you some appreciation for the sizes of different address spaces. At one point in time, a 32-bit address space seemed impossibly large. But now there are database and scientific applications that need more, and you can expect this trend to continue. At some point in your lifetime, expect to find yourself complaining about the cramped 64-bit address space on your personal computer!</p>
<table id="P7000497027000000000000000046263" data-uri="chapter09.xhtml#P7000497027000000000000000046263" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P7000497027000000000000000046264" data-uri="chapter09.xhtml#P7000497027000000000000000046264" class="pcalibre1 pcalibre2 calibre5"><span class="pcalibre1 pcalibre2 pcalibre5" id="P7000497027000000000000000007785" title="881" data-uri="chapter09.xhtml#P7000497027000000000000000007785" epub:type="pagebreak"></span>Number of address bits <i class="pcalibre17 pcalibre2 pcalibre1">(n)</i></th>
<th id="P7000497027000000000000000046265" data-uri="chapter09.xhtml#P7000497027000000000000000046265" class="pcalibre1 pcalibre2 calibre5">Number of virtual addresses <i class="pcalibre17 pcalibre2 pcalibre1">(N)</i></th>
<th id="P7000497027000000000000000046266" data-uri="chapter09.xhtml#P7000497027000000000000000046266" class="pcalibre1 pcalibre2 calibre5">Largest possible virtual address</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046267" data-uri="chapter09.xhtml#P7000497027000000000000000046267" class="pcalibre1 pcalibre2 calibre7">8</td>
<td id="P7000497027000000000000000046268" data-uri="chapter09.xhtml#P7000497027000000000000000046268" class="pcalibre1 pcalibre2 calibre7"><i class="pcalibre17 pcalibre2 pcalibre1">2<sup class="pcalibre1 pcalibre2 calibre8">s</sup></i> = 256</td>
<td id="P7000497027000000000000000046269" data-uri="chapter09.xhtml#P7000497027000000000000000046269" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">8</sup> - 1 = 255</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004626A" data-uri="chapter09.xhtml#P700049702700000000000000004626A" class="pcalibre1 pcalibre2 calibre7">16</td>
<td id="P700049702700000000000000004626B" data-uri="chapter09.xhtml#P700049702700000000000000004626B" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">16</sup> = 64 K</td>
<td id="P700049702700000000000000004626C" data-uri="chapter09.xhtml#P700049702700000000000000004626C" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">16</sup> – 1 = 64 K – 1</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004626D" data-uri="chapter09.xhtml#P700049702700000000000000004626D" class="pcalibre1 pcalibre2 calibre7">32</td>
<td id="P700049702700000000000000004626E" data-uri="chapter09.xhtml#P700049702700000000000000004626E" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">32</sup> = 4 G</td>
<td id="P700049702700000000000000004626F" data-uri="chapter09.xhtml#P700049702700000000000000004626F" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">32</sup> – 1 = 4 G – 1</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046270" data-uri="chapter09.xhtml#P7000497027000000000000000046270" class="pcalibre1 pcalibre2 calibre7">48</td>
<td id="P7000497027000000000000000046271" data-uri="chapter09.xhtml#P7000497027000000000000000046271" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">48</sup> = 256 T</td>
<td id="P7000497027000000000000000046272" data-uri="chapter09.xhtml#P7000497027000000000000000046272" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">48</sup> – 1 = 256 T – 1</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046273" data-uri="chapter09.xhtml#P7000497027000000000000000046273" class="pcalibre1 pcalibre2 calibre7">64</td>
<td id="P7000497027000000000000000046274" data-uri="chapter09.xhtml#P7000497027000000000000000046274" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">64</sup> = 16,384 P</td>
<td id="P7000497027000000000000000046275" data-uri="chapter09.xhtml#P7000497027000000000000000046275" class="pcalibre1 pcalibre2 calibre7">2<sup class="pcalibre1 pcalibre2 calibre8">64</sup> – 1 = 16,384P – 1</td>
</tr>
</tbody>
</table>
</li></ul>
</section>
<section id="P7000497027000000000000000007797" data-uri="chapter09.xhtml#P7000497027000000000000000007797" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P7000497027000000000000000046276" data-uri="chapter09.xhtml#P7000497027000000000000000046276" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP7000497027000000000000000007062.xhtml#P7000497027000000000000000007085"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.2 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP7000497027000000000000000007062.xhtml#P700049702700000000000000000707D">807</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P7000497027000000000000000046277" data-uri="chapter09.xhtml#P7000497027000000000000000046277">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046278" data-uri="chapter09.xhtml#P7000497027000000000000000046278"><p id="P7000497027000000000000000046279" data-uri="chapter09.xhtml#P7000497027000000000000000046279" class="pcalibre1 pcalibre2 pcalibre40">Since each virtual page is <var class="pcalibre17 pcalibre2 pcalibre1">P</var> = 2<i class="pcalibre17 pcalibre2 pcalibre1"><sup class="pcalibre1 pcalibre2 pcalibre85">P</sup></i> bytes, there are a total of 2<i class="pcalibre17 pcalibre2 pcalibre1"><sup class="pcalibre1 pcalibre2 pcalibre85">n</sup></i>/2<sup class="pcalibre1 pcalibre2 pcalibre85"><var class="pcalibre17 pcalibre2 pcalibre1">p</var></sup> = 2<sup class="pcalibre1 pcalibre2 pcalibre85"><i class="pcalibre17 pcalibre2 pcalibre1">n–p</i></sup>possible pages in the system, each of which needs a page table entry (PTE).</p>
<table id="P700049702700000000000000004627A" data-uri="chapter09.xhtml#P700049702700000000000000004627A" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P700049702700000000000000004627B" data-uri="chapter09.xhtml#P700049702700000000000000004627B" class="pcalibre1 pcalibre2 calibre5"><var class="pcalibre17 pcalibre2 pcalibre1">n</var></th>
<th id="P700049702700000000000000004627C" data-uri="chapter09.xhtml#P700049702700000000000000004627C" class="pcalibre1 pcalibre2 calibre5"><var class="pcalibre17 pcalibre2 pcalibre1">P</var> = 2<i class="pcalibre17 pcalibre2 pcalibre1"><sup class="pcalibre1 pcalibre2 calibre8">p</sup></i></th>
<th id="P700049702700000000000000004627D" data-uri="chapter09.xhtml#P700049702700000000000000004627D" class="pcalibre1 pcalibre2 calibre5">Number of PTEs</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004627E" data-uri="chapter09.xhtml#P700049702700000000000000004627E" class="pcalibre1 pcalibre2 calibre7">16</td>
<td id="P700049702700000000000000004627F" data-uri="chapter09.xhtml#P700049702700000000000000004627F" class="pcalibre1 pcalibre2 calibre7">4 K</td>
<td id="P7000497027000000000000000046280" data-uri="chapter09.xhtml#P7000497027000000000000000046280" class="pcalibre1 pcalibre2 calibre7">16</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046281" data-uri="chapter09.xhtml#P7000497027000000000000000046281" class="pcalibre1 pcalibre2 calibre7">16</td>
<td id="P7000497027000000000000000046282" data-uri="chapter09.xhtml#P7000497027000000000000000046282" class="pcalibre1 pcalibre2 calibre7">8 K</td>
<td id="P7000497027000000000000000046283" data-uri="chapter09.xhtml#P7000497027000000000000000046283" class="pcalibre1 pcalibre2 calibre7">8</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046284" data-uri="chapter09.xhtml#P7000497027000000000000000046284" class="pcalibre1 pcalibre2 calibre7">32</td>
<td id="P7000497027000000000000000046285" data-uri="chapter09.xhtml#P7000497027000000000000000046285" class="pcalibre1 pcalibre2 calibre7">4 K</td>
<td id="P7000497027000000000000000046286" data-uri="chapter09.xhtml#P7000497027000000000000000046286" class="pcalibre1 pcalibre2 calibre7">1 M</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046287" data-uri="chapter09.xhtml#P7000497027000000000000000046287" class="pcalibre1 pcalibre2 calibre7">32</td>
<td id="P7000497027000000000000000046288" data-uri="chapter09.xhtml#P7000497027000000000000000046288" class="pcalibre1 pcalibre2 calibre7">8 K</td>
<td id="P7000497027000000000000000046289" data-uri="chapter09.xhtml#P7000497027000000000000000046289" class="pcalibre1 pcalibre2 calibre7">512 K</td>
</tr>
</tbody>
</table>
</li></ul>
</section>
<section id="P70004970270000000000000000077AC" data-uri="chapter09.xhtml#P70004970270000000000000000077AC" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P700049702700000000000000004628A" data-uri="chapter09.xhtml#P700049702700000000000000004628A" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP70004970270000000000000000070F6.xhtml#P7000497027000000000000000007145"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.3 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP70004970270000000000000000070F6.xhtml#P700049702700000000000000000713D">816</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P700049702700000000000000004628B" data-uri="chapter09.xhtml#P700049702700000000000000004628B">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P700049702700000000000000004628C" data-uri="chapter09.xhtml#P700049702700000000000000004628C"><p id="P700049702700000000000000004628D" data-uri="chapter09.xhtml#P700049702700000000000000004628D" class="pcalibre1 pcalibre2 pcalibre40">You need to understand this kind of problem well in order to fully grasp address translation. Here is how to solve the first subproblem: We are given <var class="pcalibre17 pcalibre2 pcalibre1">n</var> = 32 virtual address bits and <var class="pcalibre17 pcalibre2 pcalibre1">m</var> = 24 physical address bits. A page size of <var class="pcalibre17 pcalibre2 pcalibre1">P</var> = 1 KB means we need log<sub class="pcalibre1 pcalibre2 calibre14">2</sub> (1 K) = 10 bits for both the VPO and PPO. (Recall that the VPO and PPO are identical.) The remaining address bits are the VPN and PPN, respectively.</p>
<table id="P700049702700000000000000004628E" data-uri="chapter09.xhtml#P700049702700000000000000004628E" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P700049702700000000000000004628F" data-uri="chapter09.xhtml#P700049702700000000000000004628F" class="pcalibre1 pcalibre2 calibre5"/>
<th colspan="4" id="P7000497027000000000000000046290" data-uri="chapter09.xhtml#P7000497027000000000000000046290" class="pcalibre1 pcalibre2 calibre5">Number of</th>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P7000497027000000000000000046291" data-uri="chapter09.xhtml#P7000497027000000000000000046291" class="pcalibre1 pcalibre2 calibre5"><var class="pcalibre17 pcalibre2 pcalibre1">p</var></th>
<th id="P7000497027000000000000000046292" data-uri="chapter09.xhtml#P7000497027000000000000000046292" class="pcalibre1 pcalibre2 calibre5">VPN bits</th>
<th id="P7000497027000000000000000046293" data-uri="chapter09.xhtml#P7000497027000000000000000046293" class="pcalibre1 pcalibre2 calibre5">VPO bits</th>
<th id="P7000497027000000000000000046294" data-uri="chapter09.xhtml#P7000497027000000000000000046294" class="pcalibre1 pcalibre2 calibre5">PPN bits</th>
<th id="P7000497027000000000000000046295" data-uri="chapter09.xhtml#P7000497027000000000000000046295" class="pcalibre1 pcalibre2 calibre5">PPO bits</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046296" data-uri="chapter09.xhtml#P7000497027000000000000000046296" class="pcalibre1 pcalibre2 calibre7">1 KB</td>
<td id="P7000497027000000000000000046297" data-uri="chapter09.xhtml#P7000497027000000000000000046297" class="pcalibre1 pcalibre2 calibre7">22</td>
<td id="P7000497027000000000000000046298" data-uri="chapter09.xhtml#P7000497027000000000000000046298" class="pcalibre1 pcalibre2 calibre7">10</td>
<td id="P7000497027000000000000000046299" data-uri="chapter09.xhtml#P7000497027000000000000000046299" class="pcalibre1 pcalibre2 calibre7">14</td>
<td id="P700049702700000000000000004629A" data-uri="chapter09.xhtml#P700049702700000000000000004629A" class="pcalibre1 pcalibre2 calibre7">10</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004629B" data-uri="chapter09.xhtml#P700049702700000000000000004629B" class="pcalibre1 pcalibre2 calibre7">2 KB</td>
<td id="P700049702700000000000000004629C" data-uri="chapter09.xhtml#P700049702700000000000000004629C" class="pcalibre1 pcalibre2 calibre7">21</td>
<td id="P700049702700000000000000004629D" data-uri="chapter09.xhtml#P700049702700000000000000004629D" class="pcalibre1 pcalibre2 calibre7">11</td>
<td id="P700049702700000000000000004629E" data-uri="chapter09.xhtml#P700049702700000000000000004629E" class="pcalibre1 pcalibre2 calibre7">13</td>
<td id="P700049702700000000000000004629F" data-uri="chapter09.xhtml#P700049702700000000000000004629F" class="pcalibre1 pcalibre2 calibre7">11</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462A0" data-uri="chapter09.xhtml#P70004970270000000000000000462A0" class="pcalibre1 pcalibre2 calibre7">4 KB</td>
<td id="P70004970270000000000000000462A1" data-uri="chapter09.xhtml#P70004970270000000000000000462A1" class="pcalibre1 pcalibre2 calibre7">20</td>
<td id="P70004970270000000000000000462A2" data-uri="chapter09.xhtml#P70004970270000000000000000462A2" class="pcalibre1 pcalibre2 calibre7">12</td>
<td id="P70004970270000000000000000462A3" data-uri="chapter09.xhtml#P70004970270000000000000000462A3" class="pcalibre1 pcalibre2 calibre7">12</td>
<td id="P70004970270000000000000000462A4" data-uri="chapter09.xhtml#P70004970270000000000000000462A4" class="pcalibre1 pcalibre2 calibre7">12</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462A5" data-uri="chapter09.xhtml#P70004970270000000000000000462A5" class="pcalibre1 pcalibre2 calibre7">8 KB</td>
<td id="P70004970270000000000000000462A6" data-uri="chapter09.xhtml#P70004970270000000000000000462A6" class="pcalibre1 pcalibre2 calibre7">19</td>
<td id="P70004970270000000000000000462A7" data-uri="chapter09.xhtml#P70004970270000000000000000462A7" class="pcalibre1 pcalibre2 calibre7">13</td>
<td id="P70004970270000000000000000462A8" data-uri="chapter09.xhtml#P70004970270000000000000000462A8" class="pcalibre1 pcalibre2 calibre7">11</td>
<td id="P70004970270000000000000000462A9" data-uri="chapter09.xhtml#P70004970270000000000000000462A9" class="pcalibre1 pcalibre2 calibre7">13</td>
</tr>
</tbody>
</table>
</li></ul>
</section>
<section id="P70004970270000000000000000077CD" data-uri="chapter09.xhtml#P70004970270000000000000000077CD" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P70004970270000000000000000462AA" data-uri="chapter09.xhtml#P70004970270000000000000000462AA" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP70004970270000000000000000070F6.xhtml#P70004970270000000000000000071E3"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.4 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP70004970270000000000000000070F6.xhtml#P70004970270000000000000000071DD">824</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P70004970270000000000000000462AB" data-uri="chapter09.xhtml#P70004970270000000000000000462AB">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P70004970270000000000000000462AC" data-uri="chapter09.xhtml#P70004970270000000000000000462AC"><p id="P70004970270000000000000000462AD" data-uri="chapter09.xhtml#P70004970270000000000000000462AD" class="pcalibre1 pcalibre2 pcalibre40">Doing a few of these manual simulations is a great way to firm up your understanding of address translation. You might find it helpful to write out all the bits in the addresses and then draw boxes around the different bit fields, such as VPN, TLBI, and so on. In this particular problem, there are no misses of any kind: the TLB has a copy of the PTE and the cache has a copy of the requested data words. See <a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP7000497027000000000000000007663.xhtml#P7000497027000000000000000007665"><span class="pcalibre1 pcalibre21 pcalibre2">Problems </span><span class="pcalibre1 pcalibre21 pcalibre2">9.11</span></a>, <a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP7000497027000000000000000007663.xhtml#P7000497027000000000000000007698"><span class="pcalibre1 pcalibre21 pcalibre2">9.12</span></a>, and <a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP7000497027000000000000000007663.xhtml#P70004970270000000000000000076CB"><span class="pcalibre1 pcalibre21 pcalibre2">9.13</span></a> for some different combinations of hits and misses.</p>
<ol class="pcalibre1 pcalibre2 pcalibre79" id="P70004970270000000000000000462AE" data-uri="chapter09.xhtml#P70004970270000000000000000462AE">
<li id="P70004970270000000000000000462AF" data-uri="chapter09.xhtml#P70004970270000000000000000462AF" class="pcalibre39 pcalibre2 pcalibre1"><p id="P70004970270000000000000000462B0" data-uri="chapter09.xhtml#P70004970270000000000000000462B0" class="pcalibre1 pcalibre2 pcalibre40"><span class="pcalibre1 pcalibre2 pcalibre5" id="P70004970270000000000000000077D5" title="882" data-uri="chapter09.xhtml#P70004970270000000000000000077D5" epub:type="pagebreak"></span><code id="P70004970270000000000000000462B1" data-uri="chapter09.xhtml#P70004970270000000000000000462B1" class="pcalibre1 calibre1 pcalibre2">00 0011 1101 Olli</code></p></li>
<li id="P70004970270000000000000000462B2" data-uri="chapter09.xhtml#P70004970270000000000000000462B2" class="pcalibre39 pcalibre2 pcalibre1"><p id="P70004970270000000000000000462B3" data-uri="chapter09.xhtml#P70004970270000000000000000462B3" class="pcalibre1 pcalibre2 pcalibre40"></p>
<table id="P70004970270000000000000000462B4" data-uri="chapter09.xhtml#P70004970270000000000000000462B4" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P70004970270000000000000000462B5" data-uri="chapter09.xhtml#P70004970270000000000000000462B5" class="pcalibre1 pcalibre2 calibre5">Parameter</th>
<th id="P70004970270000000000000000462B6" data-uri="chapter09.xhtml#P70004970270000000000000000462B6" class="pcalibre1 pcalibre2 calibre5">Value</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462B7" data-uri="chapter09.xhtml#P70004970270000000000000000462B7" class="pcalibre1 pcalibre2 calibre7">VPN</td>
<td id="P70004970270000000000000000462B8" data-uri="chapter09.xhtml#P70004970270000000000000000462B8" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462B9" data-uri="chapter09.xhtml#P70004970270000000000000000462B9" class="calibre3 pcalibre1 pcalibre2">0xf</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462BA" data-uri="chapter09.xhtml#P70004970270000000000000000462BA" class="pcalibre1 pcalibre2 calibre7">TLB index</td>
<td id="P70004970270000000000000000462BB" data-uri="chapter09.xhtml#P70004970270000000000000000462BB" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462BC" data-uri="chapter09.xhtml#P70004970270000000000000000462BC" class="calibre3 pcalibre1 pcalibre2">0x3</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462BD" data-uri="chapter09.xhtml#P70004970270000000000000000462BD" class="pcalibre1 pcalibre2 calibre7">TLB tag</td>
<td id="P70004970270000000000000000462BE" data-uri="chapter09.xhtml#P70004970270000000000000000462BE" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462BF" data-uri="chapter09.xhtml#P70004970270000000000000000462BF" class="calibre3 pcalibre1 pcalibre2">0x3</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462C0" data-uri="chapter09.xhtml#P70004970270000000000000000462C0" class="pcalibre1 pcalibre2 calibre7">TLB hit? (Y/N)</td>
<td id="P70004970270000000000000000462C1" data-uri="chapter09.xhtml#P70004970270000000000000000462C1" class="pcalibre1 pcalibre2 calibre7">Y</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462C2" data-uri="chapter09.xhtml#P70004970270000000000000000462C2" class="pcalibre1 pcalibre2 calibre7">Page fault? (Y/N)</td>
<td id="P70004970270000000000000000462C3" data-uri="chapter09.xhtml#P70004970270000000000000000462C3" class="pcalibre1 pcalibre2 calibre7">N</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462C4" data-uri="chapter09.xhtml#P70004970270000000000000000462C4" class="pcalibre1 pcalibre2 calibre7">PPN</td>
<td id="P70004970270000000000000000462C5" data-uri="chapter09.xhtml#P70004970270000000000000000462C5" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462C6" data-uri="chapter09.xhtml#P70004970270000000000000000462C6" class="calibre3 pcalibre1 pcalibre2">0xd</code></td>
</tr>
</tbody>
</table>
</li>
<li id="P70004970270000000000000000462C7" data-uri="chapter09.xhtml#P70004970270000000000000000462C7" class="pcalibre39 pcalibre2 pcalibre1"><p id="P70004970270000000000000000462C8" data-uri="chapter09.xhtml#P70004970270000000000000000462C8" class="pcalibre1 pcalibre2 pcalibre40"><code id="P70004970270000000000000000462C9" data-uri="chapter09.xhtml#P70004970270000000000000000462C9" class="pcalibre1 calibre1 pcalibre2">0011 0101 Olli</code></p></li>
<li id="P70004970270000000000000000462CA" data-uri="chapter09.xhtml#P70004970270000000000000000462CA" class="pcalibre39 pcalibre2 pcalibre1"><p id="P70004970270000000000000000462CB" data-uri="chapter09.xhtml#P70004970270000000000000000462CB" class="pcalibre1 pcalibre2 pcalibre40"></p>
<table id="P70004970270000000000000000462CC" data-uri="chapter09.xhtml#P70004970270000000000000000462CC" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P70004970270000000000000000462CD" data-uri="chapter09.xhtml#P70004970270000000000000000462CD" class="pcalibre1 pcalibre2 calibre5">Parameter</th>
<th id="P70004970270000000000000000462CE" data-uri="chapter09.xhtml#P70004970270000000000000000462CE" class="pcalibre1 pcalibre2 calibre5">Value</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462CF" data-uri="chapter09.xhtml#P70004970270000000000000000462CF" class="pcalibre1 pcalibre2 calibre7">Byte offset</td>
<td id="P70004970270000000000000000462D0" data-uri="chapter09.xhtml#P70004970270000000000000000462D0" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462D1" data-uri="chapter09.xhtml#P70004970270000000000000000462D1" class="calibre3 pcalibre1 pcalibre2">0x3</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462D2" data-uri="chapter09.xhtml#P70004970270000000000000000462D2" class="pcalibre1 pcalibre2 calibre7">Cache index</td>
<td id="P70004970270000000000000000462D3" data-uri="chapter09.xhtml#P70004970270000000000000000462D3" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462D4" data-uri="chapter09.xhtml#P70004970270000000000000000462D4" class="calibre3 pcalibre1 pcalibre2">0x5</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462D5" data-uri="chapter09.xhtml#P70004970270000000000000000462D5" class="pcalibre1 pcalibre2 calibre7">Cache tag</td>
<td id="P70004970270000000000000000462D6" data-uri="chapter09.xhtml#P70004970270000000000000000462D6" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462D7" data-uri="chapter09.xhtml#P70004970270000000000000000462D7" class="calibre3 pcalibre1 pcalibre2">0xd</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462D8" data-uri="chapter09.xhtml#P70004970270000000000000000462D8" class="pcalibre1 pcalibre2 calibre7">Cache hit? (Y/N)</td>
<td id="P70004970270000000000000000462D9" data-uri="chapter09.xhtml#P70004970270000000000000000462D9" class="pcalibre1 pcalibre2 calibre7">Y</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462DA" data-uri="chapter09.xhtml#P70004970270000000000000000462DA" class="pcalibre1 pcalibre2 calibre7">Cache byte returned</td>
<td id="P70004970270000000000000000462DB" data-uri="chapter09.xhtml#P70004970270000000000000000462DB" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462DC" data-uri="chapter09.xhtml#P70004970270000000000000000462DC" class="calibre3 pcalibre1 pcalibre2">0x1d</code></td>
</tr>
</tbody>
</table>
</li></ol></li></ul>
</section>
<section id="P7000497027000000000000000007802" data-uri="chapter09.xhtml#P7000497027000000000000000007802" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P70004970270000000000000000462DD" data-uri="chapter09.xhtml#P70004970270000000000000000462DD" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP70004970270000000000000000072B5.xhtml#P7000497027000000000000000007333"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.5 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP70004970270000000000000000072B5.xhtml#P7000497027000000000000000007329">839</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P70004970270000000000000000462DE" data-uri="chapter09.xhtml#P70004970270000000000000000462DE">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P70004970270000000000000000462DF" data-uri="chapter09.xhtml#P70004970270000000000000000462DF"><p id="P70004970270000000000000000462E0" data-uri="chapter09.xhtml#P70004970270000000000000000462E0" class="pcalibre1 pcalibre2 pcalibre40">Solving this problem will give you a good feel for the idea of memory mapping. Try it yourself. We haven't discussed the <code id="P70004970270000000000000000462E1" data-uri="chapter09.xhtml#P70004970270000000000000000462E1" class="pcalibre1 calibre1 pcalibre2">open, fstat</code>, or <code id="P70004970270000000000000000462E2" data-uri="chapter09.xhtml#P70004970270000000000000000462E2" class="pcalibre1 calibre1 pcalibre2">write</code> functions, so you'll need to read their man pages to see how they work.</p>
<p id="P70004970270000000000000000462E3" data-uri="chapter09.xhtml#P70004970270000000000000000462E3" class="pcalibre1 pcalibre2 pcalibre42">____________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/mmapcopy.c</i></p>
<pre id="P70004970270000000000000000462E4" data-uri="chapter09.xhtml#P70004970270000000000000000462E4" class="calibre2 pcalibre2 pcalibre1"><code id="P70004970270000000000000000462E5" data-uri="chapter09.xhtml#P70004970270000000000000000462E5" class="calibre3 pcalibre1 pcalibre2">
1	#include "csapp.h"
2	
3	/*
4		* mmapcopy - uses mmap to copy file fd to stdout
5		*/
6	void mmapcopy(int fd, int size)
7	{
8			char *bufp; /* ptr to memory-mapped VM area */
9	
10			bufp = MmapCNULL, size, PROT_READ, MAP_PRIVATE, fd, 0);
11			Write(1, bufp, size);
12			return;
13	}
14	
15	/* mmapcopy driver */
16	int main(int argc, char **argv)
17	{
18			struct stat stat;
19			int fd;
20	
<span class="pcalibre1 pcalibre2 pcalibre5" id="P700049702700000000000000000780C" title="883" data-uri="chapter09.xhtml#P700049702700000000000000000780C" epub:type="pagebreak"></span>21		/* Check for required command-line argument */
22		if (argc != 2) {
23			printf("usage : %s &lt;filename&gt;\n", argv[0]);
24			exit(0);
25		}
26	
27		/* Copy the input argument to stdout */
28		fd = Open(argv[1], O_RDONLY, 0);
29		fstat(fd, festat);
30		mmapcopy(fd, stat.st_size);
31		exit(0);
32	}
</code></pre>
<p id="P70004970270000000000000000462E6" data-uri="chapter09.xhtml#P70004970270000000000000000462E6" class="pcalibre1 pcalibre2 pcalibre40">__________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/mmapcopy.c</i></p>
</li></ul>
</section>
<section id="P700049702700000000000000000780E" data-uri="chapter09.xhtml#P700049702700000000000000000780E" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P70004970270000000000000000462E7" data-uri="chapter09.xhtml#P70004970270000000000000000462E7" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007415"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.6 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007417">849</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P70004970270000000000000000462E8" data-uri="chapter09.xhtml#P70004970270000000000000000462E8">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P70004970270000000000000000462E9" data-uri="chapter09.xhtml#P70004970270000000000000000462E9"><p id="P70004970270000000000000000462EA" data-uri="chapter09.xhtml#P70004970270000000000000000462EA" class="pcalibre1 pcalibre2 pcalibre40">This problem touches on some core ideas such as alignment requirements, minimum block sizes, and header encodings. The general approach for determining the block size is to round the sum of the requested payload and the header size to the nearest multiple of the alignment requirement (in this case, 8 bytes). For example, the block size for the <code id="P70004970270000000000000000462EB" data-uri="chapter09.xhtml#P70004970270000000000000000462EB" class="pcalibre1 calibre1 pcalibre2">malloc (1)</code> request is 4 + 1 = 5 rounded up to 8. The block size for the <code id="P70004970270000000000000000462EC" data-uri="chapter09.xhtml#P70004970270000000000000000462EC" class="pcalibre1 calibre1 pcalibre2">malloc (13)</code> request is 13 + 4 = 17 rounded up to 24.</p>
<table id="P70004970270000000000000000462ED" data-uri="chapter09.xhtml#P70004970270000000000000000462ED" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P70004970270000000000000000462EE" data-uri="chapter09.xhtml#P70004970270000000000000000462EE" class="pcalibre1 pcalibre2 calibre5">Request</th>
<th id="P70004970270000000000000000462EF" data-uri="chapter09.xhtml#P70004970270000000000000000462EF" class="pcalibre1 pcalibre2 calibre5">Block size (decimal bytes)</th>
<th id="P70004970270000000000000000462F0" data-uri="chapter09.xhtml#P70004970270000000000000000462F0" class="pcalibre1 pcalibre2 calibre5">Block header (hex)</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462F1" data-uri="chapter09.xhtml#P70004970270000000000000000462F1" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462F2" data-uri="chapter09.xhtml#P70004970270000000000000000462F2" class="calibre3 pcalibre1 pcalibre2">malloc(1)</code></td>
<td id="P70004970270000000000000000462F3" data-uri="chapter09.xhtml#P70004970270000000000000000462F3" class="pcalibre1 pcalibre2 calibre7">8</td>
<td id="P70004970270000000000000000462F4" data-uri="chapter09.xhtml#P70004970270000000000000000462F4" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462F5" data-uri="chapter09.xhtml#P70004970270000000000000000462F5" class="calibre3 pcalibre1 pcalibre2">0x9</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462F6" data-uri="chapter09.xhtml#P70004970270000000000000000462F6" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462F7" data-uri="chapter09.xhtml#P70004970270000000000000000462F7" class="calibre3 pcalibre1 pcalibre2">malloc(5)</code></td>
<td id="P70004970270000000000000000462F8" data-uri="chapter09.xhtml#P70004970270000000000000000462F8" class="pcalibre1 pcalibre2 calibre7">16</td>
<td id="P70004970270000000000000000462F9" data-uri="chapter09.xhtml#P70004970270000000000000000462F9" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462FA" data-uri="chapter09.xhtml#P70004970270000000000000000462FA" class="calibre3 pcalibre1 pcalibre2">0x11</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P70004970270000000000000000462FB" data-uri="chapter09.xhtml#P70004970270000000000000000462FB" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462FC" data-uri="chapter09.xhtml#P70004970270000000000000000462FC" class="calibre3 pcalibre1 pcalibre2">malloc(12)</code></td>
<td id="P70004970270000000000000000462FD" data-uri="chapter09.xhtml#P70004970270000000000000000462FD" class="pcalibre1 pcalibre2 calibre7">16</td>
<td id="P70004970270000000000000000462FE" data-uri="chapter09.xhtml#P70004970270000000000000000462FE" class="pcalibre1 pcalibre2 calibre7"><code id="P70004970270000000000000000462FF" data-uri="chapter09.xhtml#P70004970270000000000000000462FF" class="calibre3 pcalibre1 pcalibre2">0x11</code></td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046300" data-uri="chapter09.xhtml#P7000497027000000000000000046300" class="pcalibre1 pcalibre2 calibre7"><code id="P7000497027000000000000000046301" data-uri="chapter09.xhtml#P7000497027000000000000000046301" class="calibre3 pcalibre1 pcalibre2">malloc(13)</code></td>
<td id="P7000497027000000000000000046302" data-uri="chapter09.xhtml#P7000497027000000000000000046302" class="pcalibre1 pcalibre2 calibre7">24</td>
<td id="P7000497027000000000000000046303" data-uri="chapter09.xhtml#P7000497027000000000000000046303" class="pcalibre1 pcalibre2 calibre7"><code id="P7000497027000000000000000046304" data-uri="chapter09.xhtml#P7000497027000000000000000046304" class="calibre3 pcalibre1 pcalibre2">0x19</code></td>
</tr>
</tbody>
</table>
</li></ul>
</section>
<section id="P700049702700000000000000000782D" data-uri="chapter09.xhtml#P700049702700000000000000000782D" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P7000497027000000000000000046305" data-uri="chapter09.xhtml#P7000497027000000000000000046305" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000733C.xhtml#P700049702700000000000000000746C"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.7 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007462">852</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P7000497027000000000000000046306" data-uri="chapter09.xhtml#P7000497027000000000000000046306">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046307" data-uri="chapter09.xhtml#P7000497027000000000000000046307"><p id="P7000497027000000000000000046308" data-uri="chapter09.xhtml#P7000497027000000000000000046308" class="pcalibre1 pcalibre2 pcalibre40">The minimum block size can have a significant effect on internal fragmentation. Thus, it is good to understand the minimum block sizes associated with different allocator designs and alignment requirements. The tricky part is to realize that the same block can be allocated or free at different points in time. Thus, the minimum block size is the maximum of the minimum allocated block size and the minimum free block size. For example, in the last subproblem, the minimum allocated block size is a 4-byte header and a 1-byte payload rounded up to 8 bytes. The minimum free block size is a 4-byte header and 4-byte footer, which is already a multiple of 8 and doesn't need to be rounded. So the minimum block size for this allocator is 8 bytes.</p>
<table id="P7000497027000000000000000046309" data-uri="chapter09.xhtml#P7000497027000000000000000046309" class="pcalibre1 pcalibre2 pcalibre43">
<thead class="pcalibre44 pcalibre2 pcalibre1">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<th id="P700049702700000000000000004630A" data-uri="chapter09.xhtml#P700049702700000000000000004630A" class="pcalibre1 pcalibre2 calibre5">Alignment</th>
<th id="P700049702700000000000000004630B" data-uri="chapter09.xhtml#P700049702700000000000000004630B" class="pcalibre1 pcalibre2 calibre5">Allocated block</th>
<th id="P700049702700000000000000004630C" data-uri="chapter09.xhtml#P700049702700000000000000004630C" class="pcalibre1 pcalibre2 calibre5">Free block</th>
<th id="P700049702700000000000000004630D" data-uri="chapter09.xhtml#P700049702700000000000000004630D" class="pcalibre1 pcalibre2 calibre5">Minimum block size (bytes)</th>
</tr>
</thead>
<tbody class="pcalibre1 pcalibre2 calibre6">
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004630E" data-uri="chapter09.xhtml#P700049702700000000000000004630E" class="pcalibre1 pcalibre2 calibre7">Single word</td>
<td id="P700049702700000000000000004630F" data-uri="chapter09.xhtml#P700049702700000000000000004630F" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P7000497027000000000000000046310" data-uri="chapter09.xhtml#P7000497027000000000000000046310" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P7000497027000000000000000046311" data-uri="chapter09.xhtml#P7000497027000000000000000046311" class="pcalibre1 pcalibre2 calibre7">12</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046312" data-uri="chapter09.xhtml#P7000497027000000000000000046312" class="pcalibre1 pcalibre2 calibre7">Single word</td>
<td id="P7000497027000000000000000046313" data-uri="chapter09.xhtml#P7000497027000000000000000046313" class="pcalibre1 pcalibre2 calibre7">Header, but no footer</td>
<td id="P7000497027000000000000000046314" data-uri="chapter09.xhtml#P7000497027000000000000000046314" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P7000497027000000000000000046315" data-uri="chapter09.xhtml#P7000497027000000000000000046315" class="pcalibre1 pcalibre2 calibre7">8</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P7000497027000000000000000046316" data-uri="chapter09.xhtml#P7000497027000000000000000046316" class="pcalibre1 pcalibre2 calibre7">Double word</td>
<td id="P7000497027000000000000000046317" data-uri="chapter09.xhtml#P7000497027000000000000000046317" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P7000497027000000000000000046318" data-uri="chapter09.xhtml#P7000497027000000000000000046318" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P7000497027000000000000000046319" data-uri="chapter09.xhtml#P7000497027000000000000000046319" class="pcalibre1 pcalibre2 calibre7">16</td>
</tr>
<tr class="pcalibre45 pcalibre1 pcalibre2">
<td id="P700049702700000000000000004631A" data-uri="chapter09.xhtml#P700049702700000000000000004631A" class="pcalibre1 pcalibre2 calibre7">Double word</td>
<td id="P700049702700000000000000004631B" data-uri="chapter09.xhtml#P700049702700000000000000004631B" class="pcalibre1 pcalibre2 calibre7">Header, but no footer</td>
<td id="P700049702700000000000000004631C" data-uri="chapter09.xhtml#P700049702700000000000000004631C" class="pcalibre1 pcalibre2 calibre7">Header and footer</td>
<td id="P700049702700000000000000004631D" data-uri="chapter09.xhtml#P700049702700000000000000004631D" class="pcalibre1 pcalibre2 calibre7">8</td>
</tr>
</tbody>
</table>
</li></ul>
</section>
<section id="P7000497027000000000000000007847" data-uri="chapter09.xhtml#P7000497027000000000000000007847" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P700049702700000000000000004631E" data-uri="chapter09.xhtml#P700049702700000000000000004631E" epub:type="title"><span class="pcalibre1 pcalibre2 pcalibre5" id="P7000497027000000000000000007849" title="884" data-uri="chapter09.xhtml#P7000497027000000000000000007849" epub:type="pagebreak"></span><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000733C.xhtml#P700049702700000000000000000751B"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.8 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007514">861</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P700049702700000000000000004631F" data-uri="chapter09.xhtml#P700049702700000000000000004631F">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046320" data-uri="chapter09.xhtml#P7000497027000000000000000046320"><p id="P7000497027000000000000000046321" data-uri="chapter09.xhtml#P7000497027000000000000000046321" class="pcalibre1 pcalibre2 pcalibre40">There is nothing very tricky here. But the solution requires you to understand how the rest of our simple implicit-list allocator works and how to manipulate and traverse blocks.</p>
<p id="P7000497027000000000000000046322" data-uri="chapter09.xhtml#P7000497027000000000000000046322" class="pcalibre1 pcalibre2 pcalibre42">_______________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/malloc/mm.c</i></p>
<pre id="P7000497027000000000000000046323" data-uri="chapter09.xhtml#P7000497027000000000000000046323" class="calibre2 pcalibre2 pcalibre1"><code id="P7000497027000000000000000046324" data-uri="chapter09.xhtml#P7000497027000000000000000046324" class="calibre3 pcalibre1 pcalibre2">
1	static void *find_fit(size_t asize)
2	{
3		/* First-fit search */
4		void *bp;
5	
6		for (bp = heap_listp; GET_SIZE(HDRP(bp)) &gt; 0; bp = NEXT_BLKP(bp)) {
7			if (!GET_ALLOC(HDRP(bp)) &amp;&amp; (asize &lt;= GET_SIZE(HDRP(bp)))) {
8				return bp;
9			}
10		}
11		return NULL; /* No fit */
12	#endif
13	}
</code></pre>
<p id="P7000497027000000000000000046325" data-uri="chapter09.xhtml#P7000497027000000000000000046325" class="pcalibre1 pcalibre2 pcalibre40">______________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/malloc/mm.c</i></p>
</li></ul>
</section>
<section id="P7000497027000000000000000007851" data-uri="chapter09.xhtml#P7000497027000000000000000007851" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P7000497027000000000000000046326" data-uri="chapter09.xhtml#P7000497027000000000000000046326" epub:type="title"><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007525"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.9 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007514">861</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P7000497027000000000000000046327" data-uri="chapter09.xhtml#P7000497027000000000000000046327">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046328" data-uri="chapter09.xhtml#P7000497027000000000000000046328"><p id="P7000497027000000000000000046329" data-uri="chapter09.xhtml#P7000497027000000000000000046329" class="pcalibre1 pcalibre2 pcalibre40">This is another warm-up exercise to help you become familiar with allocators. Notice that for this allocator the minimum block size is 16 bytes. If the remainder of the block after splitting would be greater than or equal to the minimum block size, then we go ahead and split the block (lines 6–10). The only tricky part here is to realize that you need to place the new allocated block (lines 6 and 7) before moving to the next block (line 8).</p>
<p id="P700049702700000000000000004632A" data-uri="chapter09.xhtml#P700049702700000000000000004632A" class="pcalibre1 pcalibre2 pcalibre42">___________________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/malloc/mm.c</i></p>
<pre id="P700049702700000000000000004632B" data-uri="chapter09.xhtml#P700049702700000000000000004632B" class="calibre2 pcalibre2 pcalibre1"><code id="P700049702700000000000000004632C" data-uri="chapter09.xhtml#P700049702700000000000000004632C" class="calibre3 pcalibre1 pcalibre2">
1	static void place(void *bp, size_t asize)
2	{
3		size_t csize = GET_SIZE(HDRP(bp));
4	
5		if ((csize - asize) &gt;= (2*DSIZE)) {
6			PUT(HDRP(bp), PACK(asize, 1));
7			PUT(FTRP(bp), PACK(asize, 1));
8			bp = NEXT_BLKP(bp);
9			PUT(HDRP(bp), PACK(csize-asize, 0));
10			PUT(FTRP(bp), PACK(csize-asize, 0));
11		}
12		else {
13			PUT(HDRP(bp), PACK(csize, 1));
14			PUT(FTRP(bp), PACK(csize, 1));
15		}
16	}
</code></pre>
<p id="P700049702700000000000000004632D" data-uri="chapter09.xhtml#P700049702700000000000000004632D" class="pcalibre1 pcalibre2 pcalibre40">_____________________________________________________________________________<i class="pcalibre17 pcalibre2 pcalibre1">code/vm/malloc/mm.c</i></p>
</li></ul>
</section>
<section id="P700049702700000000000000000785A" data-uri="chapter09.xhtml#P700049702700000000000000000785A" class="pcalibre1 pcalibre2 pcalibre3"><header class="pcalibre1 pcalibre2 calibre"><h1 class="pcalibre30 pcalibre1 pcalibre2" id="P700049702700000000000000004632E" data-uri="chapter09.xhtml#P700049702700000000000000004632E" epub:type="title"><span class="pcalibre1 pcalibre2 pcalibre5" id="P700049702700000000000000000785C" title="885" data-uri="chapter09.xhtml#P700049702700000000000000000785C" epub:type="pagebreak"></span><a class="pcalibre15 pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre28" href="fileP700049702700000000000000000733C.xhtml#P700049702700000000000000000754E"><span class="pcalibre1 pcalibre21 pcalibre2">Solution to Problem </span><span class="pcalibre1 pcalibre21 pcalibre2">9.10 </span></a>(page <a class="pcalibre1 pcalibre2 pcalibre16 pcalibre14 pcalibre15 pcalibre13" epub:type="pagebreak" href="fileP700049702700000000000000000733C.xhtml#P7000497027000000000000000007548">864</a>)</h1></header>
<ul class="pcalibre38 pcalibre1 pcalibre2" id="P700049702700000000000000004632F" data-uri="chapter09.xhtml#P700049702700000000000000004632F">
<li class="pcalibre39 pcalibre2 pcalibre1" id="P7000497027000000000000000046330" data-uri="chapter09.xhtml#P7000497027000000000000000046330"><p id="P7000497027000000000000000046331" data-uri="chapter09.xhtml#P7000497027000000000000000046331" class="pcalibre1 pcalibre2 pcalibre40">Here is one pattern that will cause external fragmentation: The application makes numerous allocation and free requests to the first size class, followed by numerous allocation and free requests to the second size class, followed by numerous allocation and free requests to the third size class, and so on. For each size class, the allocator creates a lot of memory that is never reclaimed because the allocator doesn't coalesce, and because the application never requests blocks from that size class again.<span class="pcalibre1 pcalibre2 pcalibre5" id="P7000497027000000000000000007860" title="886" data-uri="chapter09.xhtml#P7000497027000000000000000007860" epub:type="pagebreak"></span></p></li></ul>
</section>
</section></body></html>
