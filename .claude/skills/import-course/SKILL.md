---
name: import-course
description: Import a course from an EPUB book into the database by reading course-plan.json files and creating course, parts, and chapters via the API. Use when the user wants to add a new book/course to the Brainer system.
---

# Import Course

## Overview

This skill automates the process of importing a course from an EPUB book into the Brainer database. It reads course-plan.json files from book directories (generated by `/reformat-epub`), translates titles to French, and creates all entities in the database via REST API calls.

**Prerequisites:** The book must have been processed by `/reformat-epub` first to generate the `course-plan.json` file.

## When to Use This Skill

Invoke this skill when the user wants to:
- Import a new book/course into Brainer (after running `/reformat-epub`)
- Add a course from the books/ directory to the database
- Create the course structure (course, parts, chapters) in the database

**Important:** Run `/reformat-epub` first to generate the `course-plan.json` file.

## Workflow

### Step 0: Clear Temp Directory

**The script automatically clears the `temp/` directory at startup** to ensure a clean state.

### Step 1: Find Course Plan

Search for `course-plan.json` files in book directories within `books/`:
- If a specific book directory name is provided, load its `course-plan.json`
- If no name provided, list all available books with `course-plan.json` files
- The script looks for: `books/<book-directory>/course-plan.json`

**Note:** The `course-plan.json` file is generated by the `/reformat-epub` skill and contains the complete course structure.

### Step 2: Load Course Structure

Load the `course-plan.json` file from the book directory:
- Contains course metadata (title, slug, author)
- Contains parts structure with order and titles
- Contains chapters with order, titles, slugs, and source files
- No parsing needed - the file is already in the correct format

### Step 3: Adapt to French and Generate Description

**⚠️ IMPORTANT: All titles must be adapted to French AND paraphrased to avoid plagiarism. Slugs must be generated from the French titles.**

1. Read the `course-plan.json` file from the book directory
2. Adapt ALL titles (course, parts, chapters) to French — **paraphrase, don't copy**:
   - **NOT a literal translation** — rephrase to express the same idea differently
   - The goal is anti-plagiarism: the French title must not be a word-for-word translation of the original
   - Preserve technical terms when appropriate (e.g., "Data Engineering" → "Ingénierie des données")
   - Reframe the angle when needed (e.g., "Storing Data at Scale" → "Systèmes de stockage pour le Big Data")
3. **Generate a concise course description** (1-2 sentences):
   - Summarize what the course covers
   - Highlight key topics and technologies
   - Keep it clear and informative (NOT just author name)
   - Example: "Guide complet de Docker, des concepts de base aux fonctionnalités avancées : conteneurs, images, réseaux, volumes, Compose, Swarm et sécurité."
4. **Generate slugs from the French titles** (NOT from the original English slugs):
   - Take the French title, lowercase it, replace spaces and special chars with hyphens, remove accents
   - Example: "Ingénierie des données" → `ingenierie-des-donnees`
   - Example: "Chapitre 1 : Premiers pas" → `chapitre-1-premiers-pas`
   - Course slug: derived from the French course title
   - Chapter slugs: derived from the French chapter title (include chapter number)
5. Save the adapted version as `temp/course-plan-fr.json`
6. The script will use the French version for database import

**Adaptation Guidelines:**
- Course title: Clear, professional French paraphrase (e.g., "Fundamentals of Data Engineering" → "Maîtriser l'ingénierie des données")
- Course description: Concise 1-2 sentence summary highlighting key topics (NOT author name)
- Part titles: Natural French structure, rephrased (e.g., "Part I: Introduction" → "Partie I : Les fondamentaux")
- **Chapter titles: ALWAYS include "Chapitre X:" prefix** (e.g., "Chapter 1: Getting Started" → "Chapitre 1 : Prise en main")
  - Translate "Chapter" to "Chapitre" and add proper French spacing before the colon
  - Paraphrase the chapter title — avoid literal translations
- Keep technical keywords recognizable for search/SEO
- **Slugs MUST be derived from the French titles** — never copy the English slug

### Step 4: Create Course in Database

Make API calls to create the course structure:

1. **Create Course** (`POST /api/courses`)
   ```json
   {
     "title": "Course title from TOC (in French)",
     "slug": "course-slug",
     "description": "Brief 1-2 sentence course description (in French)"
   }
   ```

2. **Create Parts** (`POST /api/courses/{slug}/parts` for each part)
   ```json
   {
     "order": 1,
     "title": "Part title from TOC",
     "description": ""
   }
   ```

3. **Create Chapters** (`POST /api/courses/{slug}/chapters` for each chapter)
   ```json
   {
     "part_id": 123,
     "order": 1,
     "title": "Chapter title from TOC",
     "slug": "chapter-slug",
     "content": "<p>Chapter content will be added later</p>"
   }
   ```

### Step 5: Report Results

Display a summary:
- Course created with slug (in French)
- Number of parts created
- Number of chapters created
- Direct link to view the course in the frontend

## Important Notes

- **Prerequisites:** Run `/reformat-epub` first to generate `course-plan.json` in the book directory
- **Backend must be running** on `http://localhost:8000` (or configured API URL)
- **`BRAINER_TOKEN` required:** Write endpoints are protected. Get a token first:
  ```bash
  curl -s -X POST http://localhost:8000/api/auth/login \
    -H "Content-Type: application/json" \
    -d '{"email":"you@example.com","password":"yourpassword"}' | python3 -c "import sys,json; print(json.load(sys.stdin)['access_token'])"
  export BRAINER_TOKEN=<token>
  ```
- **All titles MUST be in French** - the skill translates and uses `temp/course-plan-fr.json`
- **Temp directory is cleared** at the start of each import to ensure a clean state
- The skill creates the **structure only** (course, parts, chapters with placeholder content)
- Chapter **content extraction** from XHTML files is done separately via `/create-chapters`
- Images are handled by the `/create-chapters` skill
- If the course slug already exists in the database, the API will return an error

## Script Reference

This skill uses `.claude/skills/import-course/scripts/import_course.py` which:
- Clears the `temp/` directory at startup for a clean state
- Finds `course-plan.json` files in book directories
- Loads the course plan from the book directory
- Expects Claude to translate titles and create `temp/course-plan-fr.json`
- Makes REST API calls using the `requests` library
- Handles errors gracefully (missing files, API failures, etc.)
- Reads API URL from environment variable `API_URL` (defaults to `http://localhost:8000`)

## Example Usage

**User request:**
> "Import the Docker Deep Dive book into the database"

**Skill actions:**
1. Clear `temp/` directory
2. Find `books/deep-dive-docker/course-plan.json`
3. Load course plan (English version)
4. **Adapt to French (paraphrased)** → generate `temp/course-plan-fr.json` with:
   - Course: "Maîtriser Docker" → slug: `maitriser-docker`
   - Parts: "Partie I : Comprendre les conteneurs", etc. (rephrased, not literal)
   - Chapters: "Chapitre 1 : Vue d'ensemble des conteneurs", etc. (paraphrased titles)
   - All chapter slugs derived from French titles: `chapitre-1-vue-densemble-des-conteneurs`
5. Create course with slug `maitriser-docker` (derived from French title)
6. Create parts (with French paraphrased titles)
7. Create chapters (with French paraphrased titles and French-derived slugs)
8. Report: "✅ Course imported successfully! View at http://localhost:3000/courses/maitriser-docker"

## Resources

### .claude/skills/import-course/scripts/import_course.py
Python script that performs the actual import:
- Clears `temp/` directory at startup
- Finds and validates `course-plan.json` files in book directories
- Loads course plan from book directory
- Waits for Claude to create French translation in `temp/course-plan-fr.json`
- Makes API requests to create course entities
- Provides detailed progress and error reporting

Usage:
```bash
source brainer_venv/bin/activate

# Prerequisites: Run /reformat-epub first to generate course-plan.json

# Import course (requires temp/course-plan-fr.json to exist)
python .claude/skills/import-course/scripts/import_course.py "Book Directory Name"

# Example:
python .claude/skills/import-course/scripts/import_course.py "deep-dive-docker"
```

**Note:** The book directory name should match the directory in `books/` that contains `course-plan.json`.

### references/api_endpoints.md
Documents the exact API endpoints and payload formats used for course creation.

### references/french_translation_guide.md
Complete guide for translating course, part, and chapter titles to French:
- Translation principles (pedagogical, not literal)
- Common technical terms dictionary
- Examples of good and bad translations
- Complete workflow from English plan to French import
